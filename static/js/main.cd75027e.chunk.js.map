{"version":3,"sources":["components/BlocklyWidget/index.js","util/customBlocks.js","util/challenges.js","components/Map/index.js","util/makeMapMatrix.js","util/checkFinish.js","util/hasCoordinate.js","util/apiFunctions.js","util/checkCollision.js","components/Game/index.js","components/PagingList/index.js","App.js","index.js"],"names":["memo","blocklyToolboxConfig","blocklyWorkspaceRef","style","useState","workspace","setWorkspace","blocks","useEffect","window","Blockly","Array","isArray","custom","forEach","block","Blocks","type","init","this","jsonInit","JavaScript","generatorCallback","toolbox","useMemo","builtin","kind","contents","push","inject","document","querySelector","trashcan","STATEMENT_PREFIX","addReservedWords","dispose","bind","current","className","movementForward","message0","previousStatement","nextStatement","colour","tooltip","helpUrl","movementRotate","args0","name","options","inputsInline","getFieldValue","controlsIfPath","direction","statementToCode","controlsRepeatUntilReachEnd","challenges","map","size","rows","columns","path","start","finish","Map","gameStatus","player","mapWidth","setMapWidth","updateMapWidth","width","getComputedStyle","parseInt","addEventListener","removeEventListener","mapMatrix","row","length","column","found","find","point","makeMapMatrix","index","position","angle","checkFinish","hasCoordinate","list","x","y","e","hasPathForward","Math","abs","functions","forward","lastExecutedFunction","refresh","turnLeft","turnRight","notDone","isPathForward","isPathToLeft","isPathToRight","highlightBlock","id","checkCollision","i","Game","gameRef","onGameStatusChange","setRefresh","useCallback","interpreterInitHandler","interpreter","globalObject","that","Object","keys","apiFunctions","key","setProperty","createNativeFunction","PaginList","total","onChange","end","indexes","onClick","getPlayerInitialCoordinates","App","challengeIndex","setChallengeIndex","setGameStatus","useRef","simulationStatus","status","handleStopResetClick","assign","buttonClickHandlers","stop","code","workspaceToCode","Interpreter","nextStep","step","setTimeout","f","needExecutionDelay","running","collision","fail","pageIndex","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.cd75027e.chunk.js","sourcesContent":["import React, { useEffect, useState, useMemo, memo } from \"react\";\nimport Blockly from \"blockly\";\n\nimport \"./styles.sass\";\n\nexport default memo(function BlocklyWidget({ blocklyToolboxConfig, blocklyWorkspaceRef, style }) {\n  const [workspace, setWorkspace] = useState(null);\n\n  const blocks = blocklyToolboxConfig && blocklyToolboxConfig.blocks;\n\n  useEffect(() => {\n    window.Blockly = Blockly;\n  });\n\n  useEffect(() => {\n    if (!blocks || !Array.isArray(blocks.custom)) return;\n\n    blocks.custom.forEach((block) => {\n      Blockly.Blocks[block.type] = {\n        init: function () {\n          this.jsonInit(block);\n        },\n      };\n\n      Blockly.JavaScript[block.type] = block.generatorCallback;\n    });\n  }, [workspace, blocks]);\n\n  const toolbox = useMemo(() => {\n    if (!blocks || (!blocks.builtin && !blocks.custom)) return;\n\n    const toolbox = {\n      kind: \"flyoutToolbox\",\n      contents: [],\n    };\n\n    if (blocks.builtin && Array.isArray(blocks.builtin))\n      blocks.builtin.forEach((type) => toolbox.contents.push({ kind: \"block\", type }));\n\n    if (blocks.custom && Array.isArray(blocks.custom))\n      blocks.custom.forEach(({ type }) => toolbox.contents.push({ kind: \"block\", type }));\n\n    return toolbox;\n  }, [blocks]);\n\n  useEffect(() => {\n    const workspace = Blockly.inject(document.querySelector(\".blockly-div\"), {\n      toolbox,\n      trashcan: true,\n    });\n    setWorkspace(workspace);\n\n    Blockly.JavaScript.STATEMENT_PREFIX = \"highlightBlock(%1);\\n\";\n    Blockly.JavaScript.addReservedWords(\"highlightBlock\");\n\n    return workspace.dispose.bind(workspace);\n  }, [toolbox]);\n\n  useEffect(() => {\n    blocklyWorkspaceRef.current = workspace;\n  }, [workspace, blocklyWorkspaceRef]);\n\n  return <div className=\"blockly-div\" style={style} />;\n});\n","// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#8wpthh\nexport const movementForward = {\n  type: \"movement_forward\",\n  message0: \"forward\",\n  previousStatement: null,\n  nextStatement: null,\n  colour: 285,\n  tooltip: \"Moves one step forward\",\n  helpUrl: \"\",\n  generatorCallback: () => \"forward();\\n\",\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#83j9gt\nexport const movementRotate = {\n  type: \"movement_rotate\",\n  message0: \"turn %1 %2\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"left ↺\", \"L\"],\n        [\"right ↻\", \"R\"],\n      ],\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 285,\n  tooltip: \"Turn to the specified direction\",\n  helpUrl: \"\",\n  generatorCallback: (block) =>\n    block.getFieldValue(\"direction\") === \"L\" ? \"turnLeft();\\n\" : \"turnRight();\\n\",\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#m5x4ff\nexport const controlsIfPath = {\n  type: \"controls_if_path\",\n  message0: \"if path %1 %2 %3 do %4\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"ahead\", \"A\"],\n        [\"to the left ↺\", \"L\"],\n        [\"to the right ↻\", \"R\"],\n      ],\n    },\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"statement\",\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 210,\n  tooltip: \"Execute the 'do' statement if is possible to go to the specified direction\",\n  helpUrl: \"\",\n  generatorCallback: (block) => {\n    const direction = block.getFieldValue(\"direction\");\n    const condition =\n      direction === \"A\"\n        ? \"isPathForward()\"\n        : direction === \"L\"\n        ? \"isPathToLeft()\"\n        : \"isPathToRight()\";\n\n    return `if (${condition}) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"statement\") || \"\"}\n}`;\n  },\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#buty92\nexport const controlsIfElsePath = {\n  type: \"controls_if_else_path\",\n  message0: \"if path %1 %2 %3 do %4 else %5\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"ahead\", \"A\"],\n        [\"to the left ↺\", \"L\"],\n        [\"to the right ↻\", \"R\"],\n      ],\n    },\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"truthy_statement\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"falsy_statement\",\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 210,\n  tooltip:\n    \"Execute the 'do' statement if is possible to go to the specified direction. Otherwise, it executes the 'else' statement.\",\n  helpUrl: \"\",\n  generatorCallback: (block) => {\n    const direction = block.getFieldValue(\"direction\");\n    const condition =\n      direction === \"A\"\n        ? \"isPathForward()\"\n        : direction === \"L\"\n        ? \"isPathToLeft()\"\n        : \"isPathToRight()\";\n\n    return `if (${condition}) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"truthy_statement\") || \"\"}\n} else {\n  ${window.Blockly.JavaScript.statementToCode(block, \"falsy_statement\") || \"\"}\n}`;\n  },\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#9ag263\nexport const controlsRepeatUntilReachEnd = {\n  type: \"controls_repeat_until_reach_end\",\n  message0: \"repeat until ⚐ %1 do %2\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"statement\",\n    },\n  ],\n  previousStatement: null,\n  nextStatement: null,\n  colour: 120,\n  tooltip: \"Repeat the inside code until end is reached\",\n  helpUrl: \"\",\n  generatorCallback: (block) => `while (notDone()) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"statement\") || \"\"}\n}`,\n};\n\nconst customBlocks = {\n  movementForward,\n  movementRotate,\n  controlsIfPath,\n  controlsIfElsePath,\n  controlsRepeatUntilReachEnd,\n};\n\nexport default customBlocks;\n","import {\n  movementForward,\n  movementRotate,\n  controlsIfPath,\n  controlsIfElsePath,\n  controlsRepeatUntilReachEnd,\n} from \"./customBlocks\";\n\nconst challenges = [\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n      ],\n      start: [9, 10],\n      finish: [11, 10],\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate, controlsRepeatUntilReachEnd],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n        [11, 9],\n        [11, 8],\n        [11, 7],\n        [11, 6],\n        [11, 5],\n      ],\n      start: [9, 10],\n      finish: [11, 5],\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate, controlsIfPath, controlsRepeatUntilReachEnd],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n        [11, 9],\n        [11, 8],\n        [11, 7],\n        [11, 6],\n        [11, 5],\n        [12, 5],\n        [13, 5],\n        [14, 5],\n      ],\n      start: [9, 10],\n      finish: [14, 5],\n    },\n  },\n];\n\nexport default challenges;\n","import React, { useState, useEffect } from \"react\";\n\nimport makeMapMatrix from \"../../util/makeMapMatrix\";\nimport \"./styles.sass\";\n\nexport default function Map({ gameStatus, map, player }) {\n  const [mapWidth, setMapWidth] = useState(0);\n\n  useEffect(() => {\n    function updateMapWidth() {\n      const { width } = window.getComputedStyle(document.querySelector(\".game .map\"));\n      setMapWidth(parseInt(width) || 0);\n    }\n\n    updateMapWidth();\n\n    window.addEventListener(\"resize\", updateMapWidth);\n    return () => window.removeEventListener(\"resize\", updateMapWidth);\n  }, [setMapWidth]);\n\n  const rows = map.size && map.size.rows ? map.size.rows : 10;\n  const columns = map.size && map.size.columns ? map.size.columns : 10;\n\n  const mapMatrix = makeMapMatrix({ map, rows, columns });\n\n  return (\n    <div className=\"map\" style={{ \"--columns\": columns, \"--rows\": rows, \"--map-width\": mapWidth }}>\n      {mapMatrix.map((row, index) => (\n        <div key={`row-${index}`} className=\"row\">\n          {row.map((column, index) => (\n            <div key={`column-${index}`} className={`column ${column}`}>\n              {column === \"finish\" ? \"⚐\" : \"\"}\n            </div>\n          ))}\n        </div>\n      ))}\n      <div\n        className={`player ${gameStatus || \"\"}`}\n        style={{\n          \"--column\": player.position[0],\n          \"--row\": player.position[1],\n          \"--angle\": -player.angle,\n        }}\n      >\n        ➤\n      </div>\n    </div>\n  );\n}\n","export default function makeMapMatrix({ map, rows, columns }) {\n  const mapMatrix = [];\n\n  for (let row = 0; row < rows; row++) {\n    mapMatrix[row] = [];\n    mapMatrix[row].length = columns;\n  }\n\n  for (let row = 0; row < rows; row++)\n    for (let column = 0; column < columns; column++) {\n      const found = map.path.find((point) => point[0] === column && point[1] === row);\n      mapMatrix[row][column] = found ? \"path\" : \"extern\";\n    }\n\n  if (map.start) mapMatrix[map.start[1]][map.start[0]] = \"start\";\n  if (map.finish) mapMatrix[map.finish[1]][map.finish[0]] = \"finish\";\n\n  return mapMatrix;\n}\n","export default function checkFinish({ player, map }) {\n  if (!player || !Array.isArray(player.position) || !map || !Array.isArray(map.finish))\n    return false;\n\n  return player.position[0] === map.finish[0] && player.position[1] === map.finish[1];\n}\n","export default function hasCoordinate([x, y], list) {\n  if (!Array.isArray(list)) return false;\n\n  return list.find((e) => e[0] === x && e[1] === y);\n}\n","import checkFinish from \"./checkFinish\";\nimport hasCoordinate from \"./hasCoordinate\";\n\nexport function forward() {\n  this.workspace.lastExecutedFunction = \"forward\";\n\n  const angle = Math.abs((this.player.angle % 360) + 360) % 360;\n  const x = this.player.position[0];\n  const y = this.player.position[1];\n  const { columns, rows } = this.map.size;\n\n  if (angle === 0 && x + 1 < columns) this.player.position[0]++;\n  else if (angle === 90 && y) this.player.position[1]--;\n  else if (angle === 180 && x) this.player.position[0]--;\n  else if (angle === 270 && y + 1 < rows) this.player.position[1]++;\n\n  this.refresh();\n}\n\nexport function turnLeft() {\n  this.workspace.lastExecutedFunction = \"turnLeft\";\n\n  this.player.angle += 90;\n  this.refresh();\n}\n\nexport function turnRight() {\n  this.workspace.lastExecutedFunction = \"turnRight\";\n\n  this.player.angle -= 90;\n  this.refresh();\n}\n\nexport function notDone() {\n  this.workspace.lastExecutedFunction = \"notDone\";\n\n  return !checkFinish({ player: this.player, map: this.map });\n}\n\nfunction hasPathForward(angle, player, map) {\n  angle = Math.abs((angle % 360) + 360) % 360;\n  const x = player.position[0];\n  const y = player.position[1];\n  const { columns, rows } = map.size;\n\n  if (angle === 0) return x < columns - 1 && hasCoordinate([x + 1, y], map.path);\n  if (angle === 90) return y > 0 && hasCoordinate([x, y - 1], map.path);\n  if (angle === 180) return x > 0 && hasCoordinate([x - 1, y], map.path);\n  if (angle === 270) return y < rows - 1 && hasCoordinate([x, y + 1], map.path);\n\n  return false;\n}\n\nexport function isPathForward() {\n  this.workspace.lastExecutedFunction = \"isPathForward\";\n\n  return hasPathForward(this.player.angle, this.player, this.map);\n}\n\nexport function isPathToLeft() {\n  this.workspace.lastExecutedFunction = \"isPathToLeft\";\n\n  return hasPathForward(this.player.angle + 90, this.player, this.map);\n}\n\nexport function isPathToRight() {\n  this.workspace.lastExecutedFunction = \"isPathToRight\";\n\n  return hasPathForward(this.player.angle - 90, this.player, this.map);\n}\n\nexport function highlightBlock(id) {\n  this.workspace.highlightBlock(id);\n}\n\nconst functions = {\n  forward,\n  turnLeft,\n  turnRight,\n  notDone,\n  isPathForward,\n  isPathToLeft,\n  isPathToRight,\n  highlightBlock,\n};\n\nexport default functions;\n","export default function checkCollision({ player, map }) {\n  if (!player || !Array.isArray(player.position) || !map || !Array.isArray(map.path)) return false;\n\n  for (let i = 0; i < map.path.length; i++)\n    if (map.path[i][0] === player.position[0] && map.path[i][1] === player.position[1])\n      return false;\n\n  return true;\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\r\n\r\nimport Map from \"../Map\";\r\nimport apiFunctions from \"../../util/apiFunctions\";\r\nimport checkCollision from \"../../util/checkCollision\";\r\n\r\nimport \"./styles.sass\";\r\n\r\nexport default function Game({\r\n  gameRef,\r\n  gameStatus,\r\n  onGameStatusChange,\r\n  map,\r\n  player,\r\n  blocklyWorkspaceRef,\r\n}) {\r\n  const [, setRefresh] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!map.start) return;\r\n\r\n    player.position[0] = map.start[0];\r\n    player.position[1] = map.start[1];\r\n  }, [map, player]);\r\n\r\n  const refresh = useCallback(() => {\r\n    if (checkCollision({ player, map })) {\r\n      onGameStatusChange(\"collision\");\r\n    }\r\n\r\n    setRefresh({});\r\n  }, [setRefresh, onGameStatusChange, player, map]);\r\n\r\n  function interpreterInitHandler(interpreter, globalObject) {\r\n    const that = {\r\n      player,\r\n      map,\r\n      workspace: blocklyWorkspaceRef && blocklyWorkspaceRef.current,\r\n      refresh,\r\n    };\r\n\r\n    Object.keys(apiFunctions).forEach((key) => {\r\n      interpreter.setProperty(\r\n        globalObject,\r\n        key,\r\n        interpreter.createNativeFunction(apiFunctions[key].bind(that))\r\n      );\r\n    });\r\n  }\r\n\r\n  gameRef.current = { interpreterInitHandler };\r\n\r\n  return (\r\n    <div className=\"game\">\r\n      <Map gameStatus={gameStatus} player={player} map={map} />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\n\nimport \"./styles.sass\";\n\nexport default function PaginList({ total, current, onChange }) {\n  const start = current - 2 < 1 ? 1 : current - 2;\n  const end = start + 4 > total ? total : start + 4;\n\n  const indexes = [];\n  for (let i = start; i <= end; i++) indexes.push(i);\n\n  return (\n    <ul className=\"paging-list\">\n      {indexes.map((i) => (\n        <li key={`${i}`} className={i === current ? \"selected\" : \"\"} onClick={() => onChange(i)}>\n          {i}\n        </li>\n      ))}\n    </ul>\n  );\n}\n","import React, { useState, useMemo, useRef, useEffect } from \"react\";\r\nimport BlocklyWidget from \"./components/BlocklyWidget\";\r\nimport Blockly from \"blockly\";\r\n\r\nimport \"./App.sass\";\r\nimport challenges from \"./util/challenges\";\r\nimport Game from \"./components/Game\";\r\nimport PagingList from \"./components/PagingList\";\r\nimport checkCollision from \"./util/checkCollision\";\r\nimport checkFinish from \"./util/checkFinish\";\r\n\r\nfunction getPlayerInitialCoordinates(start) {\r\n  const x = (Array.isArray(start) && start[0]) || 0;\r\n  const y = (Array.isArray(start) && start[1]) || 0;\r\n\r\n  return {\r\n    angle: 0,\r\n    position: [x, y],\r\n  };\r\n}\r\n\r\nconst instructionStepDelay = 500; // milliseconds\r\n\r\nexport default function App() {\r\n  const [challengeIndex, setChallengeIndex] = useState(2);\r\n  const [gameStatus, setGameStatus] = useState(\"stop\");\r\n  const blocklyWorkspaceRef = useRef(null);\r\n  const gameRef = useRef(null);\r\n  const player = useMemo(getPlayerInitialCoordinates, []);\r\n  const simulationStatus = useMemo(() => ({ status: \"stop\" }), []);\r\n\r\n  useEffect(() => {\r\n    simulationStatus.status = gameStatus;\r\n  }, [gameStatus, simulationStatus]);\r\n\r\n  useEffect(turnLastHighlightedBlockOff, [gameStatus]);\r\n\r\n  const blocklyToolboxConfig = useMemo(() => {\r\n    return challenges[challengeIndex] && challenges[challengeIndex].toolbox;\r\n  }, [challengeIndex]);\r\n\r\n  const map = useMemo(() => {\r\n    return challenges[challengeIndex] && challenges[challengeIndex].map;\r\n  }, [challengeIndex]);\r\n\r\n  function turnLastHighlightedBlockOff() {\r\n    if (blocklyWorkspaceRef.current) blocklyWorkspaceRef.current.highlightBlock();\r\n  }\r\n\r\n  function needExecutionDelay() {\r\n    const delayedFunctions = [\"forward\", \"turnLeft\", \"turnRight\"];\r\n    const found = delayedFunctions.find(\r\n      (f) => f === blocklyWorkspaceRef.current.lastExecutedFunction\r\n    );\r\n    blocklyWorkspaceRef.current.lastExecutedFunction = \"\";\r\n    return found;\r\n  }\r\n\r\n  function handleRunClick() {\r\n    if (!blocklyWorkspaceRef.current) return;\r\n\r\n    const code = Blockly.JavaScript.workspaceToCode(blocklyWorkspaceRef.current);\r\n    const interpreter = new window.Interpreter(\r\n      code,\r\n      gameRef.current && gameRef.current.interpreterInitHandler\r\n    );\r\n\r\n    function endOfSimulation() {\r\n      if (checkCollision({ player, map })) setGameStatus(\"collision\");\r\n      else if (checkFinish({ player, map })) setGameStatus(\"finish\");\r\n      else setGameStatus(\"fail\");\r\n    }\r\n\r\n    simulationStatus.status = \"running\";\r\n    setGameStatus(\"running\");\r\n\r\n    function nextStep() {\r\n      if (simulationStatus.status !== \"running\") return;\r\n\r\n      if (interpreter.step()) setTimeout(nextStep, needExecutionDelay() ? instructionStepDelay : 0);\r\n      else endOfSimulation();\r\n    }\r\n\r\n    nextStep();\r\n  }\r\n\r\n  function handleStopResetClick() {\r\n    Object.assign(player, getPlayerInitialCoordinates(challenges[challengeIndex].map.start));\r\n    setGameStatus(\"stop\");\r\n  }\r\n\r\n  function handleNextClick() {\r\n    if (challengeIndex + 1 < challenges.length) {\r\n      setChallengeIndex(challengeIndex + 1);\r\n      Object.assign(player, getPlayerInitialCoordinates(challenges[challengeIndex].map.start));\r\n      setGameStatus(\"stop\");\r\n    }\r\n  }\r\n\r\n  function handlePagingClick(pageIndex) {\r\n    setChallengeIndex(pageIndex - 1);\r\n    Object.assign(player, getPlayerInitialCoordinates(challenges[challengeIndex].map.start));\r\n    setGameStatus(\"stop\");\r\n  }\r\n\r\n  const buttonClickHandlers = {\r\n    stop: handleRunClick,\r\n    running: handleStopResetClick,\r\n    collision: handleStopResetClick,\r\n    fail: handleStopResetClick,\r\n    finish: handleNextClick,\r\n  };\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <div className=\"game-button-container\">\r\n        <PagingList\r\n          total={challenges.length}\r\n          current={challengeIndex + 1}\r\n          onChange={handlePagingClick}\r\n        />\r\n        <Game\r\n          gameRef={gameRef}\r\n          gameStatus={gameStatus}\r\n          onGameStatusChange={setGameStatus}\r\n          map={map}\r\n          player={player}\r\n          blocklyWorkspaceRef={blocklyWorkspaceRef}\r\n        />\r\n        <button onClick={buttonClickHandlers[gameStatus]} className={`run-button ${gameStatus}`} />\r\n      </div>\r\n      <BlocklyWidget\r\n        blocklyToolboxConfig={blocklyToolboxConfig}\r\n        blocklyWorkspaceRef={blocklyWorkspaceRef}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}