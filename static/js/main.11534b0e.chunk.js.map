{"version":3,"sources":["components/BlocklyWidget/index.js","util/customBlocks.js","util/challenges.js","components/Map/index.js","util/makeMapMatrix.js","util/checkFinish.js","util/hasCoordinate.js","util/apiFunctions.js","util/checkCollision.js","components/Game/index.js","components/PagingList/index.js","App.js","index.js"],"names":["memo","blocklyConfig","blocklyToolboxConfig","blocklyWorkspaceRef","setRemainingBlocks","style","useState","workspace","setWorkspace","blocks","useEffect","window","Blockly","Array","isArray","custom","forEach","block","Blocks","type","init","this","jsonInit","JavaScript","generatorCallback","addChangeListener","remainingCapacity","toolbox","useMemo","builtin","kind","contents","push","config","trashcan","inject","document","querySelector","STATEMENT_PREFIX","addReservedWords","dispose","bind","current","className","movementForward","message0","previousStatement","nextStatement","colour","tooltip","helpUrl","movementRotate","args0","name","options","inputsInline","getFieldValue","controlsIfPath","direction","statementToCode","controlsIfElsePath","controlsRepeatUntilReachEnd","challenges","map","size","rows","columns","path","start","finish","blockly","maxBlocks","Map","gameStatus","player","mapWidth","setMapWidth","updateMapWidth","width","getComputedStyle","parseInt","addEventListener","removeEventListener","mapMatrix","row","length","column","found","find","point","makeMapMatrix","index","position","angle","checkFinish","hasCoordinate","list","x","y","e","hasPathForward","Math","abs","functions","forward","lastExecutedFunction","refresh","turnLeft","turnRight","notDone","isPathForward","isPathToLeft","isPathToRight","highlightBlock","id","checkCollision","i","Game","gameRef","onGameStatusChange","remainingBlocks","setRefresh","useCallback","interpreterInitHandler","interpreter","globalObject","that","Object","keys","apiFunctions","key","setProperty","createNativeFunction","Infinity","PaginList","total","onChange","end","indexes","onClick","getPlayerInitialCoordinates","App","challengeIndex","setChallengeIndex","setGameStatus","useRef","simulationStatus","status","handleStopResetClick","assign","buttonClickHandlers","stop","code","workspaceToCode","Interpreter","nextStep","step","setTimeout","f","needExecutionDelay","running","collision","fail","pageIndex","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.11534b0e.chunk.js","sourcesContent":["import React, { useEffect, useState, useMemo, memo } from \"react\";\nimport Blockly from \"blockly\";\n\nimport \"./styles.sass\";\n\nexport default memo(function BlocklyWidget({\n  blocklyConfig,\n  blocklyToolboxConfig,\n  blocklyWorkspaceRef,\n  setRemainingBlocks,\n  style,\n}) {\n  const [workspace, setWorkspace] = useState(null);\n\n  const blocks = blocklyToolboxConfig && blocklyToolboxConfig.blocks;\n\n  useEffect(() => {\n    window.Blockly = Blockly;\n  });\n\n  useEffect(() => {\n    if (!blocks || !Array.isArray(blocks.custom)) return;\n\n    blocks.custom.forEach((block) => {\n      Blockly.Blocks[block.type] = {\n        init: function () {\n          this.jsonInit(block);\n        },\n      };\n\n      Blockly.JavaScript[block.type] = block.generatorCallback;\n    });\n  }, [workspace, blocks]);\n\n  useEffect(() => {\n    if (!workspace) return;\n\n    workspace.addChangeListener(() => {\n      setRemainingBlocks(workspace.remainingCapacity());\n    });\n\n    setRemainingBlocks(workspace.remainingCapacity());\n  }, [workspace, setRemainingBlocks]);\n\n  const toolbox = useMemo(() => {\n    if (!blocks || (!blocks.builtin && !blocks.custom)) return;\n\n    const toolbox = {\n      kind: \"flyoutToolbox\",\n      contents: [],\n    };\n\n    if (blocks.builtin && Array.isArray(blocks.builtin))\n      blocks.builtin.forEach((type) => toolbox.contents.push({ kind: \"block\", type }));\n\n    if (blocks.custom && Array.isArray(blocks.custom))\n      blocks.custom.forEach(({ type }) => toolbox.contents.push({ kind: \"block\", type }));\n\n    return toolbox;\n  }, [blocks]);\n\n  useEffect(() => {\n    const config = { ...(blocklyConfig || {}), toolbox, trashcan: true };\n    const workspace = Blockly.inject(document.querySelector(\".blockly-div\"), config);\n    setWorkspace(workspace);\n\n    Blockly.JavaScript.STATEMENT_PREFIX = \"highlightBlock(%1);\\n\";\n    Blockly.JavaScript.addReservedWords(\"highlightBlock\");\n\n    return workspace.dispose.bind(workspace);\n  }, [toolbox, blocklyConfig]);\n\n  useEffect(() => {\n    blocklyWorkspaceRef.current = workspace;\n  }, [workspace, blocklyWorkspaceRef]);\n\n  return <div className=\"blockly-div\" style={style} />;\n});\n","// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#8wpthh\nexport const movementForward = {\n  type: \"movement_forward\",\n  message0: \"forward\",\n  previousStatement: null,\n  nextStatement: null,\n  colour: 285,\n  tooltip: \"Moves one step forward\",\n  helpUrl: \"\",\n  generatorCallback: () => \"forward();\\n\",\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#83j9gt\nexport const movementRotate = {\n  type: \"movement_rotate\",\n  message0: \"turn %1 %2\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"left ↺\", \"L\"],\n        [\"right ↻\", \"R\"],\n      ],\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 285,\n  tooltip: \"Turn to the specified direction\",\n  helpUrl: \"\",\n  generatorCallback: (block) =>\n    block.getFieldValue(\"direction\") === \"L\" ? \"turnLeft();\\n\" : \"turnRight();\\n\",\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#m5x4ff\nexport const controlsIfPath = {\n  type: \"controls_if_path\",\n  message0: \"if path %1 %2 %3 do %4\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"ahead\", \"A\"],\n        [\"to the left ↺\", \"L\"],\n        [\"to the right ↻\", \"R\"],\n      ],\n    },\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"statement\",\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 210,\n  tooltip: \"Execute the 'do' statement if is possible to go to the specified direction\",\n  helpUrl: \"\",\n  generatorCallback: (block) => {\n    const direction = block.getFieldValue(\"direction\");\n    const condition =\n      direction === \"A\"\n        ? \"isPathForward()\"\n        : direction === \"L\"\n        ? \"isPathToLeft()\"\n        : \"isPathToRight()\";\n\n    return `if (${condition}) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"statement\") || \"\"}\n}`;\n  },\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#buty92\nexport const controlsIfElsePath = {\n  type: \"controls_if_else_path\",\n  message0: \"if path %1 %2 %3 do %4 else %5\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"field_dropdown\",\n      name: \"direction\",\n      options: [\n        [\"ahead\", \"A\"],\n        [\"to the left ↺\", \"L\"],\n        [\"to the right ↻\", \"R\"],\n      ],\n    },\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"truthy_statement\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"falsy_statement\",\n    },\n  ],\n  inputsInline: true,\n  previousStatement: null,\n  nextStatement: null,\n  colour: 210,\n  tooltip:\n    \"Execute the 'do' statement if is possible to go to the specified direction. Otherwise, it executes the 'else' statement.\",\n  helpUrl: \"\",\n  generatorCallback: (block) => {\n    const direction = block.getFieldValue(\"direction\");\n    const condition =\n      direction === \"A\"\n        ? \"isPathForward()\"\n        : direction === \"L\"\n        ? \"isPathToLeft()\"\n        : \"isPathToRight()\";\n\n    return `if (${condition}) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"truthy_statement\") || \"\"}\n} else {\n  ${window.Blockly.JavaScript.statementToCode(block, \"falsy_statement\") || \"\"}\n}`;\n  },\n};\n\n// source: https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#9ag263\nexport const controlsRepeatUntilReachEnd = {\n  type: \"controls_repeat_until_reach_end\",\n  message0: \"repeat until ⚐ %1 do %2\",\n  args0: [\n    {\n      type: \"input_dummy\",\n    },\n    {\n      type: \"input_statement\",\n      name: \"statement\",\n    },\n  ],\n  previousStatement: null,\n  nextStatement: null,\n  colour: 120,\n  tooltip: \"Repeat the inside code until end is reached\",\n  helpUrl: \"\",\n  generatorCallback: (block) => `while (notDone()) {\n  ${window.Blockly.JavaScript.statementToCode(block, \"statement\") || \"\"}\n}`,\n};\n\nconst customBlocks = {\n  movementForward,\n  movementRotate,\n  controlsIfPath,\n  controlsIfElsePath,\n  controlsRepeatUntilReachEnd,\n};\n\nexport default customBlocks;\n","import {\n  movementForward,\n  movementRotate,\n  controlsIfPath,\n  controlsIfElsePath,\n  controlsRepeatUntilReachEnd,\n} from \"./customBlocks\";\n\nconst challenges = [\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n      ],\n      start: [9, 10],\n      finish: [11, 10],\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate, controlsRepeatUntilReachEnd],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n        [11, 9],\n        [11, 8],\n        [11, 7],\n        [11, 6],\n        [11, 5],\n      ],\n      start: [9, 10],\n      finish: [11, 5],\n    },\n    blockly: {\n      maxBlocks: 5,\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate, controlsIfPath, controlsRepeatUntilReachEnd],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [9, 10],\n        [10, 10],\n        [11, 10],\n        [12, 10],\n        [12, 9],\n        [12, 8],\n        [12, 7],\n        [12, 6],\n        [12, 5],\n        [11, 5],\n        [10, 5],\n        [9, 5],\n        [8, 5],\n        [7, 5],\n        [6, 5],\n        [6, 6],\n        [6, 7],\n        [6, 8],\n        [6, 9],\n        [6, 10],\n      ],\n      start: [9, 10],\n      finish: [6, 10],\n    },\n    blockly: {\n      maxBlocks: 4,\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [movementForward, movementRotate, controlsIfPath, controlsRepeatUntilReachEnd],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [8, 10],\n        [9, 10],\n        [10, 10],\n        [11, 10],\n        [11, 9],\n        [11, 8],\n        [11, 7],\n        [11, 6],\n        [11, 5],\n        [11, 4],\n        [12, 4],\n        [13, 4],\n        [14, 4],\n      ],\n      start: [8, 10],\n      finish: [14, 4],\n    },\n    blockly: {\n      maxBlocks: 6,\n    },\n  },\n  {\n    toolbox: {\n      blocks: {\n        builtin: [],\n        custom: [\n          movementForward,\n          movementRotate,\n          controlsIfPath,\n          controlsIfElsePath,\n          controlsRepeatUntilReachEnd,\n        ],\n      },\n    },\n    map: {\n      size: { rows: 20, columns: 20 },\n      path: [\n        [10, 12],\n        [11, 12],\n        [12, 12],\n        [13, 12],\n        [13, 11],\n        [13, 10],\n        [13, 9],\n        [13, 8],\n        [13, 7],\n        [13, 6],\n        [13, 5],\n        [13, 4],\n        [12, 4],\n        [11, 4],\n        [10, 4],\n        [9, 4],\n        [8, 4],\n        [7, 4],\n        [6, 4],\n        [5, 4],\n        [4, 4],\n        [3, 4],\n        [2, 4],\n        [1, 4],\n\n        //little square\n        [12, 6],\n        [11, 6],\n        [11, 5],\n\n        //path to the right\n        [8, 3],\n        [8, 2],\n        [8, 1],\n        [9, 1],\n        [10, 1],\n\n        //path to the left\n        [5, 5],\n        [5, 6],\n        [5, 7],\n        [5, 8],\n        [5, 9],\n        [5, 10],\n        [5, 11],\n        [5, 12],\n        [4, 10],\n        [3, 10],\n        [6, 10],\n        [7, 10],\n      ],\n      start: [10, 12],\n      finish: [1, 4],\n    },\n    blockly: {\n      maxBlocks: 7,\n    },\n  },\n];\n\nexport default challenges;\n","import React, { useState, useEffect } from \"react\";\n\nimport makeMapMatrix from \"../../util/makeMapMatrix\";\nimport \"./styles.sass\";\n\nexport default function Map({ gameStatus, map, player }) {\n  const [mapWidth, setMapWidth] = useState(0);\n\n  useEffect(() => {\n    function updateMapWidth() {\n      const { width } = window.getComputedStyle(document.querySelector(\".game .map\"));\n      setMapWidth(parseInt(width) || 0);\n    }\n\n    updateMapWidth();\n\n    window.addEventListener(\"resize\", updateMapWidth);\n    return () => window.removeEventListener(\"resize\", updateMapWidth);\n  }, [setMapWidth]);\n\n  const rows = map.size && map.size.rows ? map.size.rows : 10;\n  const columns = map.size && map.size.columns ? map.size.columns : 10;\n\n  const mapMatrix = makeMapMatrix({ map, rows, columns });\n\n  return (\n    <div className=\"map\" style={{ \"--columns\": columns, \"--rows\": rows, \"--map-width\": mapWidth }}>\n      {mapMatrix.map((row, index) => (\n        <div key={`row-${index}`} className=\"row\">\n          {row.map((column, index) => (\n            <div key={`column-${index}`} className={`column ${column}`}>\n              {column === \"finish\" ? \"⚐\" : \"\"}\n            </div>\n          ))}\n        </div>\n      ))}\n      <div\n        className={`player ${gameStatus || \"\"}`}\n        style={{\n          \"--column\": player.position[0],\n          \"--row\": player.position[1],\n          \"--angle\": -player.angle,\n        }}\n      >\n        ➤\n      </div>\n    </div>\n  );\n}\n","export default function makeMapMatrix({ map, rows, columns }) {\n  const mapMatrix = [];\n\n  for (let row = 0; row < rows; row++) {\n    mapMatrix[row] = [];\n    mapMatrix[row].length = columns;\n  }\n\n  for (let row = 0; row < rows; row++)\n    for (let column = 0; column < columns; column++) {\n      const found = map.path.find((point) => point[0] === column && point[1] === row);\n      mapMatrix[row][column] = found ? \"path\" : \"extern\";\n    }\n\n  if (map.start) mapMatrix[map.start[1]][map.start[0]] = \"start\";\n  if (map.finish) mapMatrix[map.finish[1]][map.finish[0]] = \"finish\";\n\n  return mapMatrix;\n}\n","export default function checkFinish({ player, map }) {\n  if (!player || !Array.isArray(player.position) || !map || !Array.isArray(map.finish))\n    return false;\n\n  return player.position[0] === map.finish[0] && player.position[1] === map.finish[1];\n}\n","export default function hasCoordinate([x, y], list) {\n  if (!Array.isArray(list)) return false;\n\n  return list.find((e) => e[0] === x && e[1] === y);\n}\n","import checkFinish from \"./checkFinish\";\nimport hasCoordinate from \"./hasCoordinate\";\n\nexport function forward() {\n  this.workspace.lastExecutedFunction = \"forward\";\n\n  const angle = Math.abs((this.player.angle % 360) + 360) % 360;\n  const x = this.player.position[0];\n  const y = this.player.position[1];\n  const { columns, rows } = this.map.size;\n\n  if (angle === 0 && x + 1 < columns) this.player.position[0]++;\n  else if (angle === 90 && y) this.player.position[1]--;\n  else if (angle === 180 && x) this.player.position[0]--;\n  else if (angle === 270 && y + 1 < rows) this.player.position[1]++;\n\n  this.refresh();\n}\n\nexport function turnLeft() {\n  this.workspace.lastExecutedFunction = \"turnLeft\";\n\n  this.player.angle += 90;\n  this.refresh();\n}\n\nexport function turnRight() {\n  this.workspace.lastExecutedFunction = \"turnRight\";\n\n  this.player.angle -= 90;\n  this.refresh();\n}\n\nexport function notDone() {\n  this.workspace.lastExecutedFunction = \"notDone\";\n\n  return !checkFinish({ player: this.player, map: this.map });\n}\n\nfunction hasPathForward(angle, player, map) {\n  angle = Math.abs((angle % 360) + 360) % 360;\n  const x = player.position[0];\n  const y = player.position[1];\n  const { columns, rows } = map.size;\n\n  if (angle === 0) return x < columns - 1 && hasCoordinate([x + 1, y], map.path);\n  if (angle === 90) return y > 0 && hasCoordinate([x, y - 1], map.path);\n  if (angle === 180) return x > 0 && hasCoordinate([x - 1, y], map.path);\n  if (angle === 270) return y < rows - 1 && hasCoordinate([x, y + 1], map.path);\n\n  return false;\n}\n\nexport function isPathForward() {\n  this.workspace.lastExecutedFunction = \"isPathForward\";\n\n  return hasPathForward(this.player.angle, this.player, this.map);\n}\n\nexport function isPathToLeft() {\n  this.workspace.lastExecutedFunction = \"isPathToLeft\";\n\n  return hasPathForward(this.player.angle + 90, this.player, this.map);\n}\n\nexport function isPathToRight() {\n  this.workspace.lastExecutedFunction = \"isPathToRight\";\n\n  return hasPathForward(this.player.angle - 90, this.player, this.map);\n}\n\nexport function highlightBlock(id) {\n  this.workspace.highlightBlock(id);\n}\n\nconst functions = {\n  forward,\n  turnLeft,\n  turnRight,\n  notDone,\n  isPathForward,\n  isPathToLeft,\n  isPathToRight,\n  highlightBlock,\n};\n\nexport default functions;\n","export default function checkCollision({ player, map }) {\n  if (!player || !Array.isArray(player.position) || !map || !Array.isArray(map.path)) return false;\n\n  for (let i = 0; i < map.path.length; i++)\n    if (map.path[i][0] === player.position[0] && map.path[i][1] === player.position[1])\n      return false;\n\n  return true;\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\r\n\r\nimport Map from \"../Map\";\r\nimport apiFunctions from \"../../util/apiFunctions\";\r\nimport checkCollision from \"../../util/checkCollision\";\r\n\r\nimport \"./styles.sass\";\r\n\r\nexport default function Game({\r\n  gameRef,\r\n  gameStatus,\r\n  onGameStatusChange,\r\n  map,\r\n  player,\r\n  blocklyWorkspaceRef,\r\n  remainingBlocks,\r\n}) {\r\n  const [, setRefresh] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!map.start) return;\r\n\r\n    player.position[0] = map.start[0];\r\n    player.position[1] = map.start[1];\r\n  }, [map, player]);\r\n\r\n  const refresh = useCallback(() => {\r\n    if (checkCollision({ player, map })) {\r\n      onGameStatusChange(\"collision\");\r\n    }\r\n\r\n    setRefresh({});\r\n  }, [setRefresh, onGameStatusChange, player, map]);\r\n\r\n  function interpreterInitHandler(interpreter, globalObject) {\r\n    const that = {\r\n      player,\r\n      map,\r\n      workspace: blocklyWorkspaceRef && blocklyWorkspaceRef.current,\r\n      refresh,\r\n    };\r\n\r\n    Object.keys(apiFunctions).forEach((key) => {\r\n      interpreter.setProperty(\r\n        globalObject,\r\n        key,\r\n        interpreter.createNativeFunction(apiFunctions[key].bind(that))\r\n      );\r\n    });\r\n  }\r\n\r\n  gameRef.current = { interpreterInitHandler };\r\n\r\n  return (\r\n    <div className=\"game\">\r\n      <Map gameStatus={gameStatus} player={player} map={map} />\r\n      {remainingBlocks !== Infinity && (\r\n        <div className=\"remaining-blocks-container\">{`Remaining blocks: ${remainingBlocks}`}</div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\n\nimport \"./styles.sass\";\n\nexport default function PaginList({ total, current, onChange }) {\n  const start = total > 5 ? (current - 2 < 1 ? 1 : current - 2) : 1;\n  const end = total > 5 ? (start + 4 > total ? total : start + 4) : total;\n\n  const indexes = [];\n  for (let i = start; i <= end; i++) indexes.push(i);\n\n  return (\n    <ul className=\"paging-list\">\n      {indexes.map((i) => (\n        <li key={`${i}`} className={i === current ? \"selected\" : \"\"} onClick={() => onChange(i)}>\n          {i}\n        </li>\n      ))}\n    </ul>\n  );\n}\n","import React, { useState, useMemo, useRef, useEffect } from \"react\";\r\nimport BlocklyWidget from \"./components/BlocklyWidget\";\r\nimport Blockly from \"blockly\";\r\n\r\nimport \"./App.sass\";\r\nimport challenges from \"./util/challenges\";\r\nimport Game from \"./components/Game\";\r\nimport PagingList from \"./components/PagingList\";\r\nimport checkCollision from \"./util/checkCollision\";\r\nimport checkFinish from \"./util/checkFinish\";\r\n\r\nfunction getPlayerInitialCoordinates(start) {\r\n  const x = (Array.isArray(start) && start[0]) || 0;\r\n  const y = (Array.isArray(start) && start[1]) || 0;\r\n\r\n  return {\r\n    angle: 0,\r\n    position: [x, y],\r\n  };\r\n}\r\n\r\nconst instructionStepDelay = 500; // milliseconds\r\n\r\nexport default function App() {\r\n  const [challengeIndex, setChallengeIndex] = useState(0);\r\n  const [gameStatus, setGameStatus] = useState(\"stop\");\r\n  const [remainingBlocks, setRemainingBlocks] = useState(Infinity);\r\n  const blocklyWorkspaceRef = useRef(null);\r\n  const gameRef = useRef(null);\r\n  const player = useMemo(getPlayerInitialCoordinates, []);\r\n  const simulationStatus = useMemo(() => ({ status: \"stop\" }), []);\r\n\r\n  useEffect(() => {\r\n    simulationStatus.status = gameStatus;\r\n  }, [gameStatus, simulationStatus]);\r\n\r\n  useEffect(turnLastHighlightedBlockOff, [gameStatus]);\r\n\r\n  const blocklyToolboxConfig = useMemo(() => {\r\n    return challenges[challengeIndex] && challenges[challengeIndex].toolbox;\r\n  }, [challengeIndex]);\r\n\r\n  const blocklyConfig = useMemo(() => {\r\n    return challenges[challengeIndex] && challenges[challengeIndex].blockly;\r\n  }, [challengeIndex]);\r\n\r\n  const map = useMemo(() => {\r\n    return challenges[challengeIndex] && challenges[challengeIndex].map;\r\n  }, [challengeIndex]);\r\n\r\n  function turnLastHighlightedBlockOff() {\r\n    if (blocklyWorkspaceRef.current) blocklyWorkspaceRef.current.highlightBlock();\r\n  }\r\n\r\n  function needExecutionDelay() {\r\n    const delayedFunctions = [\"forward\", \"turnLeft\", \"turnRight\"];\r\n    const found = delayedFunctions.find(\r\n      (f) => f === blocklyWorkspaceRef.current.lastExecutedFunction\r\n    );\r\n    blocklyWorkspaceRef.current.lastExecutedFunction = \"\";\r\n    return found;\r\n  }\r\n\r\n  function handleRunClick() {\r\n    if (!blocklyWorkspaceRef.current) return;\r\n\r\n    const code = Blockly.JavaScript.workspaceToCode(blocklyWorkspaceRef.current);\r\n    const interpreter = new window.Interpreter(\r\n      code,\r\n      gameRef.current && gameRef.current.interpreterInitHandler\r\n    );\r\n\r\n    function endOfSimulation() {\r\n      if (checkCollision({ player, map })) setGameStatus(\"collision\");\r\n      else if (checkFinish({ player, map })) setGameStatus(\"finish\");\r\n      else setGameStatus(\"fail\");\r\n    }\r\n\r\n    simulationStatus.status = \"running\";\r\n    setGameStatus(\"running\");\r\n\r\n    function nextStep() {\r\n      if (simulationStatus.status !== \"running\") return;\r\n\r\n      if (interpreter.step()) setTimeout(nextStep, needExecutionDelay() ? instructionStepDelay : 0);\r\n      else endOfSimulation();\r\n    }\r\n\r\n    nextStep();\r\n  }\r\n\r\n  function handleStopResetClick() {\r\n    Object.assign(player, getPlayerInitialCoordinates(challenges[challengeIndex].map.start));\r\n    setGameStatus(\"stop\");\r\n  }\r\n\r\n  function handleNextClick() {\r\n    if (challengeIndex + 1 < challenges.length) {\r\n      setChallengeIndex(challengeIndex + 1);\r\n      Object.assign(player, getPlayerInitialCoordinates(challenges[challengeIndex + 1].map.start));\r\n      setGameStatus(\"stop\");\r\n    }\r\n  }\r\n\r\n  function handlePagingClick(pageIndex) {\r\n    setChallengeIndex(pageIndex - 1);\r\n    Object.assign(player, getPlayerInitialCoordinates(challenges[pageIndex - 1].map.start));\r\n    setGameStatus(\"stop\");\r\n  }\r\n\r\n  const buttonClickHandlers = {\r\n    stop: handleRunClick,\r\n    running: handleStopResetClick,\r\n    collision: handleStopResetClick,\r\n    fail: handleStopResetClick,\r\n    finish: handleNextClick,\r\n  };\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <div className=\"game-button-container\">\r\n        <PagingList\r\n          total={challenges.length}\r\n          current={challengeIndex + 1}\r\n          onChange={handlePagingClick}\r\n        />\r\n        <Game\r\n          remainingBlocks={remainingBlocks}\r\n          setRemainingBlocks={setRemainingBlocks}\r\n          gameRef={gameRef}\r\n          gameStatus={gameStatus}\r\n          onGameStatusChange={setGameStatus}\r\n          map={map}\r\n          player={player}\r\n          blocklyWorkspaceRef={blocklyWorkspaceRef}\r\n        />\r\n        <button onClick={buttonClickHandlers[gameStatus]} className={`run-button ${gameStatus}`} />\r\n      </div>\r\n      <BlocklyWidget\r\n        setRemainingBlocks={setRemainingBlocks}\r\n        blocklyToolboxConfig={blocklyToolboxConfig}\r\n        blocklyConfig={blocklyConfig}\r\n        blocklyWorkspaceRef={blocklyWorkspaceRef}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}